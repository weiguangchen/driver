"use strict";const e=require("../../common/vendor.js"),s=require("../../stores/user.js"),n=require("../../api/index.js"),o=require("../../utils/token.js");Math||(c+i)();const c=()=>"./login-drawer.js",i=()=>"./nickname-modal.js",r={__name:"my-login-drawer",emits:["success"],setup(c,{expose:i,emit:r}){const t=s.useUserStore(),a=r,u=e.ref(),l=e.ref();async function m(e){console.log("loginSuccess",e);const s=await t.login({mobile:e});console.log("登陆成功"),s.Nickname?a("success"):l.value.open()}async function k(e){console.log("nicknameSuccess",e);try{await n.UptDriverNickName({nickName:e}),l.value.close();const s=o.getToken();o.setToken({...s,userInfo:{...s.userInfo,Nickname:e}}),a("success")}catch{l.value.closeLoading()}}return i({open:function(){u.value.open()}}),(s,n)=>({a:e.sr(u,"c0405062-0",{k:"loginRef"}),b:e.o(m),c:e.sr(l,"c0405062-1",{k:"nicknameRef"}),d:e.o(k)})}};wx.createComponent(r);
