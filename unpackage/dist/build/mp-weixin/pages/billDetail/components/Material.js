"use strict";const o=require("../../../common/vendor.js"),e=require("../../../api/index.js"),l=require("../../../utils/token.js");if(!Array){(o.resolveComponent("uv-button")+o.resolveComponent("uv-switch")+o.resolveComponent("uv-form-item")+o.resolveComponent("my-number-box")+o.resolveComponent("uv-form")+o.resolveComponent("my-drawer"))()}Math||((()=>"../../../uni_modules/uv-button/components/uv-button/uv-button.js")+(()=>"../../../uni_modules/uv-switch/components/uv-switch/uv-switch.js")+(()=>"../../../uni_modules/uv-form/components/uv-form-item/uv-form-item.js")+(()=>"../../../components/my-number-box/my-number-box.js")+(()=>"../../../uni_modules/uv-form/components/uv-form/uv-form.js")+(()=>"../../../components/my-drawer/my-drawer.js"))();const t={options:{virtualHost:!0}},n=Object.assign(t,{__name:"Material",props:{borderBottom:{default:!1},record:{default:()=>{}},bill:{default:()=>{}}},emits:["confirm"],setup(t,{emit:n}){const i=t,r=o.computed((()=>"0"===i.bill.EntryAuthened||"1"===i.bill.EntryAuthened&&"0"===i.record.ReceiveAble)),a=n,u=o.reactive({FullLoad:!1,Load:0}),d=o.reactive({Load:[{require:!0,message:"请填写预计总重"}]});async function s(e){console.log("val",e),await o.nextTick$1(),m.value.resize()}o.watchEffect((()=>{i.record&&(u.FullLoad=i.record.FullLoad,u.Load=i.record.Load)}));const c=o.computed((()=>{var e,l,t,n,r,a;const d={"半挂车":"bgTare","自卸车":"zxTare","罐车":"gcTare"},s=(null==(l=null==(e=i.bill)?void 0:e.CarEnt)?void 0:l.CarType)??"",c=(null==d?void 0:d[s])??0,m=(null==(n=null==(t=i.bill)?void 0:t.ConfigEnt)?void 0:n[c])??0;return u.FullLoad?o.Big((null==(a=null==(r=i.bill)?void 0:r.ConfigEnt)?void 0:a.FullLoadGross)||0).minus(m).toFixed(2):o.Big(u.Load||0).minus(m).toFixed(2)})),m=o.ref();function v(){m.value.popup.open()}async function f(){var t,n,r,d,s;try{const v=l.getToken(),f={AssignId:i.bill.Id,SupplyId:null==(n=null==(t=i.bill)?void 0:t.SupEnt)?void 0:n.Id,Customer:i.bill.OwnerEnt.Id,DriverId:null==(r=null==v?void 0:v.userInfo)?void 0:r.Id,Material:i.record.Material,MatName:i.record.MaterialName,FullLoad:u.FullLoad,Load:u.FullLoad?null==(s=null==(d=null==i?void 0:i.bill)?void 0:d.ConfigEnt)?void 0:s.fullLoadGross:u.Load,Suttle:c.value};console.log("接单参数",f),await e.DriverMakeOnway(f),o.index.showToast({title:"接单成功",icon:"none"}),a("confirm"),m.value.popup.close()}catch{o.index.showToast({title:"接单失败",icon:"none"}),m.value.closeLoading()}}return(e,l)=>o.e({a:o.t(t.record.MaterialName),b:"1"===t.record.Limittype},"1"===t.record.Limittype?{c:o.t(t.record.EstimateWeight)}:{},{d:"2"===t.record.Limittype},"2"===t.record.Limittype?{e:o.t(t.record.EstimateTimes)}:{},{f:t.record.Realheight},t.record.Realheight?{g:o.t(t.record.Realheight)}:{},{h:o.o(v),i:o.p({disabled:r.value,shape:"circle",color:r.value?"#B0BECC":"linear-gradient( 270deg, #31CE57 0%, #07B130 100%)",text:"接单","custom-style":{height:"68rpx"}}),j:t.borderBottom?1:"",k:t.borderBottom?1:"",l:"1"===t.bill.ConfigEnt.fullLoad},"1"===t.bill.ConfigEnt.fullLoad?{m:o.o(s),n:o.o((o=>u.FullLoad=o)),o:o.p({"active-color":"var(--main-color)",activeValue:"1",inactiveValue:"0",modelValue:u.FullLoad}),p:o.p({prop:"FullLoad",customStyle:{padding:"28rpx 0"}})}:{},{q:"0"===u.FullLoad},"0"===u.FullLoad?{r:o.t(t.bill.ConfigEnt&&t.bill.ConfigEnt.fullLoadMin?t.bill.ConfigEnt.fullLoadMin:0),s:o.t(t.bill.ConfigEnt&&t.bill.ConfigEnt.fullLoadMax?t.bill.ConfigEnt.fullLoadMax:""),t:o.o((o=>u.Load=o)),v:o.p({min:t.bill.ConfigEnt&&t.bill.ConfigEnt.fullLoadMin?t.bill.ConfigEnt.fullLoadMin:0,max:t.bill.ConfigEnt&&t.bill.ConfigEnt.fullLoadMax?t.bill.ConfigEnt.fullLoadMax:void 0,modelValue:u.Load}),w:o.p({prop:"Load",customStyle:{padding:"28rpx 0"}})}:{},{x:o.sr("form","6b529865-2,6b529865-1"),y:o.p({labelPosition:"left",model:u,rules:d}),z:o.t(c.value),A:o.sr(m,"6b529865-1",{k:"drawer"}),B:o.o(f),C:o.p({title:"设置预计装运量",showConfirmButton:!0,confirmText:"确认订单",bgColor:"#FFFFFF",asyncClose:!0})})}}),i=o._export_sfc(n,[["__scopeId","data-v-6b529865"]]);wx.createComponent(i);
