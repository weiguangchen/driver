"use strict";const e=require("../../common/vendor.js"),o=require("../../stores/user.js"),n=require("../../utils/token.js"),r=require("../../api/index.js");if(!Array){(e.resolveComponent("uv-avatar")+e.resolveComponent("uv-icon")+e.resolveComponent("uv-button")+e.resolveComponent("my-confirm"))()}Math||((()=>"../../uni_modules/uv-avatar/components/uv-avatar/uv-avatar.js")+(()=>"../../uni_modules/uv-icon/components/uv-icon/uv-icon.js")+(()=>"../../uni_modules/uv-button/components/uv-button/uv-button.js")+(()=>"../../components/my-confirm/my-confirm.js")+t)();const t=()=>"../../components/my-login-drawer/nickname-modal.js",s={__name:"setting",setup(t){const s=o.useUserStore(),{userInfo:i}=e.storeToRefs(s),c=e.ref();function a(){const e=n.getToken().userInfo.Nickname||"";c.value.open(e)}async function u(o){console.log("nicknameSuccess",o);try{await r.UptDriverNickName({nickName:o}),c.value.close();const t=n.getToken();await n.setToken({...t,userInfo:{...t.userInfo,Nickname:o}}),s.setUserInfo({...t.userInfo,Nickname:o}),e.index.showToast({title:"修改成功",icon:"none"})}catch(t){console.log("error",t),c.value.closeLoading()}}function m(o){e.index.navigateTo({url:`/pages/agreement/agreement?type=${o}`})}const l=e.ref(null);function v(){l.value.confirm({title:"确定退出登录？",cancelText:"再想想",confirmText:"退出",async confirm(){s.logout(),e.index.reLaunch({url:"/pages/index/index"})}})}return(o,n)=>({a:e.p({src:"/static/images/mine/avatar.png",size:32}),b:e.t(e.unref(i).Nickname),c:e.p({name:"arrow-right",color:"#A0AFBA",size:"24rpx","custom-style":{marginLeft:"16rpx"}}),d:e.o(a),e:e.t(e.unref(i).Mobile),f:e.p({name:"arrow-right",color:"#A0AFBA",size:"24rpx"}),g:e.o((e=>m("driverzc"))),h:e.p({name:"arrow-right",color:"#A0AFBA",size:"24rpx"}),i:e.o((e=>m("driverxy"))),j:e.o(v),k:e.p({text:"退出登录",color:"#FFFFFF","custom-style":{height:"96rpx",borderRadius:"16rpx"},customTextStyle:{color:"var(--red-color)"}}),l:e.sr(l,"322f096b-5",{k:"confirm"}),m:e.sr(c,"322f096b-6",{k:"nicknameRef"}),n:e.o(u),o:e.p({closeOnClickOverlay:!0,showCancelButton:!0})})}};wx.createPage(s);
