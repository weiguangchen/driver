"use strict";const e=require("../../../common/vendor.js"),t=require("../../../api/index.js"),r=require("../../../utils/token.js"),o=require("../../../stores/location.js"),d=require("../../../utils/authorize.js");if(!Array){(e.resolveComponent("uv-image")+e.resolveComponent("my-plate")+e.resolveComponent("uv-line")+e.resolveComponent("uv-button")+e.resolveComponent("my-confirm"))()}Math||((()=>"../../../uni_modules/uv-image/components/uv-image/uv-image.js")+(()=>"../../../components/my-plate/my-plate.js")+(()=>"../../../uni_modules/uv-line/components/uv-line/uv-line.js")+(()=>"../../../uni_modules/uv-button/components/uv-button/uv-button.js")+(()=>"../../../components/my-confirm/my-confirm.js"))();const c={__name:"item",props:{record:{default:()=>{},type:Object}},emits:["success"],setup(c,{emit:n}){o.useLocationStore();const i=n,a=c,u=e.computed((()=>["0","1"].includes(a.record.WeightedStatus)?"待入场":["2","3","4"].includes(a.record.WeightedStatus)?"已入场":["5"].includes(a.record.WeightedStatus)?"装车中":["6"].includes(a.record.WeightedStatus)?"已装车":["7"].includes(a.record.WeightedStatus)?"已出场":["8"].includes(a.record.WeightedStatus)?"已完成":["9"].includes(a.record.WeightedStatus)?"已取消":void 0)),s=e.ref();function l(){e.index.navigateTo({url:`/pages/billDetail/billDetail?assignId=${a.record.Id}`})}function m(){s.value.confirm({title:"确认取消该笔运单？",content:"如取消次数过多，将会被限制接单",cancelText:"再想想",confirmText:"取消运单",asyncClose:!0,async confirm(){try{await t.DisableOnwayEnt({onwayId:a.record.Id,userId:r.getToken().userInfo.Id,userType:"driver"}),s.value.close(),i("success")}catch{s.value.closeLoading()}}})}function g(){var t,r;e.index.makePhoneCall({phoneNumber:(null==(r=null==(t=a.record)?void 0:t.OwnerEnt)?void 0:r.LinkerMobile)??""})}function h(){var t,r;e.index.makePhoneCall({phoneNumber:(null==(r=null==(t=a.record)?void 0:t.SupEnt)?void 0:r.LinkerMobile)??""})}async function S(){e.index.showLoading({mask:!0});let r={};try{r=await d.getLocationInfo()}catch{return s.value.confirm({title:"定位失败",content:"请开启相关定位权限或者扫码入场",showCancelButton:!1,confirmBgColor:"var(--main-color)"}),void e.index.hideLoading()}console.log("location",r);try{await t.ArrivedConfirm({onwayId:a.record.Id,logitude:r.longitude,latitude:r.latitude}),i("success")}catch(o){s.value.confirm({title:"到场失败",content:o.data,showCancelButton:!1,confirmBgColor:"var(--red-color)"})}finally{e.index.hideLoading()}}async function p(){e.index.showLoading({mask:!0});let o={};try{o=await d.getLocationInfo()}catch{return s.value.confirm({title:"定位失败",content:"请开启相关定位权限",showCancelButton:!1,confirmBgColor:"var(--main-color)"}),void e.index.hideLoading()}console.log("location",o);try{await t.UnloadConfirm({onwayId:a.record.Id,userId:r.getToken().userInfo.Id,uType:"driver",logitude:o.longitude,latitude:o.latitude}),i("success")}catch(c){s.value.confirm({title:"卸货失败",content:c.data,showCancelButton:!1,confirmBgColor:"var(--red-color)"})}finally{e.index.hideLoading()}}return(t,r)=>e.e({a:e.t(u.value),b:["8","9"].includes(c.record.WeightedStatus)?1:"",c:["0","1","2","3","4","5","6","7"].includes(c.record.WeightedStatus)?1:"",d:"0"===c.record.WeightedStatus},"0"===c.record.WeightedStatus?e.e({e:c.record.StartTime&&c.record.EndTime},c.record.StartTime&&c.record.EndTime?{f:e.t(e.unref(e.dayjs)(c.record.StartTime).format("MM-DD HH:mm")),g:e.t(e.unref(e.dayjs)(c.record.EndTime).format("MM-DD HH:mm"))}:{},{h:c.record.StartTime&&!c.record.EndTime},c.record.StartTime&&!c.record.EndTime?{i:e.t(e.unref(e.dayjs)(c.record.StartTime).format("MM-DD HH:mm"))}:{},{j:!c.record.StartTime&&c.record.EndTime},!c.record.StartTime&&c.record.EndTime?{k:e.t(e.unref(e.dayjs)(c.record.EndTime).format("MM-DD HH:mm"))}:{},{l:!c.record.StartTime&&!c.record.EndTime},(c.record.StartTime||c.record.EndTime,{})):{},{m:"1"===c.record.WeightedStatus},"1"===c.record.WeightedStatus?e.e({n:c.record.StatusCount&&c.record.StatusCount>1},c.record.StatusCount&&c.record.StatusCount>1?{o:e.t(c.record.StatusCount)}:{}):{},{p:"2"===c.record.WeightedStatus},(c.record.WeightedStatus,{}),{q:"3"===c.record.WeightedStatus},"3"===c.record.WeightedStatus?e.e({r:c.record.StatusCount&&c.record.StatusCount>1},c.record.StatusCount&&c.record.StatusCount>1?{s:e.t(c.record.StatusCount)}:{}):{},{t:"4"===c.record.WeightedStatus},(c.record.WeightedStatus,{}),{v:"5"===c.record.WeightedStatus},(c.record.WeightedStatus,{}),{w:"6"===c.record.WeightedStatus},(c.record.WeightedStatus,{}),{x:"7"===c.record.WeightedStatus},(c.record.WeightedStatus,{}),{y:"8"===c.record.WeightedStatus},(c.record.WeightedStatus,{}),{z:"9"===c.record.WeightedStatus},"9"===c.record.WeightedStatus?{A:e.t(c.record.CancelType)}:{},{B:e.t(c.record.OwnerEnt?c.record.OwnerEnt.OwnerName:""),C:c.record.SupEnt},c.record.SupEnt?{D:e.f(3,((e,t,r)=>({}))),E:e.p({src:"/static/images/dot1.png",width:"16rpx",height:"16rpx",duration:0,"custom-style":{marginRight:"16rpx"}}),F:e.t(c.record.SupEnt?c.record.SupEnt.City:""),G:e.t(c.record.SupEnt?c.record.SupEnt.SupplierName:"")}:{},{H:c.record.UnloadEnt},c.record.UnloadEnt?{I:e.p({src:"/static/images/dot2.png",width:"16rpx",height:"16rpx",duration:0,"custom-style":{marginRight:"16rpx"}}),J:e.t(c.record.UnloadEnt?c.record.UnloadEnt.City:""),K:e.t(c.record.UnloadEnt?c.record.UnloadEnt.PlaceName:"")}:{},{L:c.record.CarEnt},c.record.CarEnt?{M:e.p({plate:c.record.CarEnt.Carno,color:c.record.CarEnt.Color})}:{},{N:e.t(c.record.MaterialName?c.record.MaterialName:""),O:e.p({direction:"col",color:"#B0BECC",length:"26rpx",margin:"0 20rpx 0 20rpx"}),P:["0","1","2","3","4","5","9"].includes(c.record.WeightedStatus)},["0","1","2","3","4","5","9"].includes(c.record.WeightedStatus)?{Q:e.t(c.record.EstimiteWeight)}:{},{R:["6","7","8"].includes(c.record.WeightedStatus)},["6","7","8"].includes(c.record.WeightedStatus)?{S:e.t(c.record.WeightEnt?c.record.WeightEnt.Suttle:"")}:{},{T:["0","1"].includes(c.record.WeightedStatus)},["0","1"].includes(c.record.WeightedStatus)?{U:e.o(m),V:e.p({shape:"circle",text:"取消运单",color:"var(--page-bg)",customTextStyle:{color:"var(--content-color)",fontSize:"26rpx"},customStyle:{height:"32px"}}),W:e.o((()=>{}))}:{},{X:["0","1","7"].includes(c.record.WeightedStatus)},["0","1","7"].includes(c.record.WeightedStatus)?{Y:e.o(g),Z:e.p({shape:"circle",text:"呼叫货主",color:"var(--page-bg)",customTextStyle:{color:"var(--content-color)",fontSize:"26rpx"},customStyle:{height:"32px"}}),aa:e.o((()=>{}))}:{},{ab:["2","3","4","5","6"].includes(c.record.WeightedStatus)},["2","3","4","5","6"].includes(c.record.WeightedStatus)?{ac:e.o(h),ad:e.p({shape:"circle",text:"呼叫厂家",color:"var(--page-bg)",customTextStyle:{color:"var(--content-color)",fontSize:"26rpx"},customStyle:{height:"32px"}}),ae:e.o((()=>{}))}:{},{af:["0"].includes(c.record.WeightedStatus)},["0"].includes(c.record.WeightedStatus)?{ag:e.o(S),ah:e.p({shape:"circle",text:"确认到厂",color:"linear-gradient( 270deg, #31CE57 0%, #07B130 100%);",customTextStyle:{fontSize:"26rpx"},customStyle:{height:"32px"}}),ai:e.o((()=>{}))}:{},{aj:["7"].includes(c.record.WeightedStatus)},["7"].includes(c.record.WeightedStatus)?{ak:e.o(p),al:e.p({shape:"circle",text:"确认卸货",color:"linear-gradient( 270deg, #31CE57 0%, #07B130 100%);",customTextStyle:{fontSize:"26rpx"},customStyle:{height:"32px"}}),am:e.o((()=>{}))}:{},{an:"9"!==c.record.WeightedStatus?1:"",ao:e.o(l),ap:e.sr(s,"1743a31b-9",{k:"modal"})})}},n=e._export_sfc(c,[["__scopeId","data-v-1743a31b"]]);wx.createComponent(n);
